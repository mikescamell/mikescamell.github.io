
<head>
    <meta charset="utf-8">

    <title>How to use Shared Element Transitions with Fragments</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <link rel="shortcut icon" href="../../favicon.ico">

    <meta name="description" content="A tutorial to show how to implement simple Shared Element Transitions when going from Fragment to Fragment.">
    <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="../index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="Mike Scamell">
    <meta property="og:type" content="article">
    <meta property="og:title" content="How to use Shared Element Transitions with Fragments">
    <meta property="og:description" content="A tutorial to show how to implement simple Shared Element Transitions when going from Fragment to Fragment.">
    <meta property="og:url" content="http://localhost:2368/shared-element-transitions-part-2/">
    <meta property="og:image" content="http://localhost:2368/content/images/2018/11/shared_element_part_2-4.png">
    <meta property="article:published_time" content="2017-02-07T14:38:00.000Z">
    <meta property="article:modified_time" content="2018-11-18T21:39:10.000Z">
    <meta property="article:tag" content="androiddev">
    <meta property="article:tag" content="sharedelementtranistions">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="How to use Shared Element Transitions with Fragments">
    <meta name="twitter:description" content="A tutorial to show how to implement simple Shared Element Transitions when going from Fragment to Fragment.">
    <meta name="twitter:url" content="http://localhost:2368/shared-element-transitions-part-2/">
    <meta name="twitter:image" content="http://localhost:2368/content/images/2018/11/shared_element_part_2-4.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Mike Scamell">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="androiddev, sharedelementtranistions">
    <meta name="twitter:site" content="@mikescamell">
    <meta name="twitter:creator" content="@mikescamell">
    <meta property="og:image:width" content="1280">
    <meta property="og:image:height" content="720">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Mike Scamell",
        "logo": {
            "@type": "ImageObject",
            "url": "http://localhost:2368/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Mike Scamell",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/2a389d50c33966a79a8cf6fe29c6080e?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "http://localhost:2368/author/mike/",
        "sameAs": [
            "https://twitter.com/mikescamell"
        ]
    },
    "headline": "How to use Shared Element Transitions with Fragments",
    "url": "http://localhost:2368/shared-element-transitions-part-2/",
    "datePublished": "2017-02-07T14:38:00.000Z",
    "dateModified": "2018-11-18T21:39:10.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "http://localhost:2368/content/images/2018/11/shared_element_part_2-4.png",
        "width": 1280,
        "height": 720
    },
    "keywords": "androiddev, sharedelementtranistions",
    "description": "A tutorial to show how to implement simple Shared Element Transitions when going from Fragment to Fragment.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:2368/"
    }
}
    </script>

    <meta name="generator" content="Ghost 2.6">
    <link rel="alternate" type="application/rss+xml" title="Mike Scamell" href="../../rss/index.html">

    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,600,400">
    <style amp-custom>html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}h1{margin:0.67em 0;font-size:2em}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{position:relative;vertical-align:baseline;font-size:75%;line-height:0}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}amp-img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace, monospace;font-size:1em}button,input,optgroup,select,textarea{margin:0;color:inherit;font:inherit}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{cursor:pointer;-webkit-appearance:button}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-appearance:textfield}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{margin:0 2px;padding:0.35em 0.625em 0.75em;border:1px solid #c0c0c0}legend{padding:0;border:0}textarea{overflow:auto}optgroup{font-weight:bold}table{border-spacing:0;border-collapse:collapse}td,th{padding:0}html{max-height:100%;height:100%;font-size:62.5%;-webkit-tap-highlight-color:rgba(0, 0, 0, 0)}body{max-height:100%;height:100%;color:#3a4145;background:#f4f8fb;letter-spacing:0.01rem;font-family:"Merriweather", serif;font-size:1.8rem;line-height:1.75em;text-rendering:geometricPrecision;-webkit-font-feature-settings:"kern" 1;-moz-font-feature-settings:"kern" 1;-o-font-feature-settings:"kern" 1}::-moz-selection{background:#d6edff}::selection{background:#d6edff}h1,h2,h3,h4,h5,h6{margin:0 0 0.3em 0;color:#2e2e2e;font-family:"Open Sans", sans-serif;line-height:1.15em;text-rendering:geometricPrecision;-webkit-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1;-moz-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1;-o-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1}h1{text-indent:-2px;letter-spacing:-1px;font-size:2.6rem}h2{letter-spacing:0;font-size:2.4rem}h3{letter-spacing:-0.6px;font-size:2.1rem}h4{font-size:1.9rem}h5{font-size:1.8rem}h6{font-size:1.8rem}a{color:#4a4a4a}a:hover{color:#111}p,ul,ol,dl{margin:0 0 2.5rem 0;font-size:1.5rem;text-rendering:geometricPrecision;-webkit-font-feature-settings:"liga" 1, "onum" 1, "kern" 1;-moz-font-feature-settings:"liga" 1, "onum" 1, "kern" 1;-o-font-feature-settings:"liga" 1, "onum" 1, "kern" 1}ol,ul{padding-left:2em}ol ol,ul ul,ul ol,ol ul{margin:0 0 0.4em 0;padding-left:2em}dl dt{float:left;clear:left;overflow:hidden;margin-bottom:1em;width:180px;text-align:right;text-overflow:ellipsis;white-space:nowrap;font-weight:700}dl dd{margin-bottom:1em;margin-left:200px}li{margin:0.4em 0}li li{margin:0}hr{display:block;margin:1.75em 0;padding:0;height:1px;border:0;border-top:#efefef 1px solid}blockquote{box-sizing:border-box;margin:1.75em 0 1.75em 0;padding:0 0 0 1.75em;border-left:#4a4a4a 0.4em solid;-moz-box-sizing:border-box}blockquote p{margin:0.8em 0;font-style:italic}blockquote small{display:inline-block;margin:0.8em 0 0.8em 1.5em;color:#ccc;font-size:0.9em}blockquote small:before{content:"\2014 \00A0"}blockquote cite{font-weight:700}blockquote cite a{font-weight:normal}mark{background-color:#fdffb6}code,tt{padding:1px 3px;border:#e3edf3 1px solid;background:#f7fafb;border-radius:2px;white-space:pre-wrap;font-family:Inconsolata, monospace, sans-serif;font-size:0.85em;font-feature-settings:"liga" 0;-webkit-font-feature-settings:"liga" 0;-moz-font-feature-settings:"liga" 0}pre{overflow:auto;box-sizing:border-box;margin:0 0 1.75em 0;padding:10px;width:100%;border:#e3edf3 1px solid;background:#f7fafb;border-radius:3px;white-space:pre;font-family:Inconsolata, monospace, sans-serif;font-size:0.9em;-moz-box-sizing:border-box}pre code,pre tt{padding:0;border:none;background:transparent;white-space:pre-wrap;font-size:inherit}kbd{display:inline-block;margin-bottom:0.4em;padding:1px 8px;border:#ccc 1px solid;background:#f4f4f4;border-radius:4px;box-shadow:0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 0 #fff inset;color:#666;text-shadow:#fff 0 1px 0;font-size:0.9em;font-weight:700}table{box-sizing:border-box;margin:1.75em 0;max-width:100%;width:100%;background-color:transparent;-moz-box-sizing:border-box}table th,table td{padding:8px;border-top:#efefef 1px solid;vertical-align:top;text-align:left;line-height:20px}table th{color:#000}table caption + thead tr:first-child th,table caption + thead tr:first-child td,table colgroup + thead tr:first-child th,table colgroup + thead tr:first-child td,table thead:first-child tr:first-child th,table thead:first-child tr:first-child td{border-top:0}table tbody + tbody{border-top:#efefef 2px solid}table table table{background-color:#fff}table tbody > tr:nth-child(odd) > td,table tbody > tr:nth-child(odd) > th{background-color:#f6f6f6}table.plain tbody > tr:nth-child(odd) > td,table.plain tbody > tr:nth-child(odd) > th{background:transparent}iframe,amp-iframe,.fluid-width-video-wrapper{display:block;margin:1.75em 0}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper amp-iframe{margin:0}textarea,select,input{margin:0 0 5px 0;padding:6px 9px;width:260px;outline:0;border:#e7eef2 1px solid;background:#fff;border-radius:4px;box-shadow:none;font-family:"Open Sans", sans-serif;font-size:1.6rem;line-height:1.4em;font-weight:100;-webkit-appearance:none}textarea{min-width:250px;min-height:80px;max-width:340px;width:100%;height:auto}input[type="text"]:focus,input[type="email"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="number"]:focus,input[type="date"]:focus,input[type="month"]:focus,input[type="week"]:focus,input[type="time"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,textarea:focus{outline:none;outline-width:0;border:#bbc7cc 1px solid;background:#fff}select{width:270px;height:30px;line-height:30px}.clearfix:before,.clearfix:after{content:" ";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.main-header{position:relative;display:table;overflow:hidden;box-sizing:border-box;width:100%;height:50px;background:#5ba4e5 no-repeat center center;background-size:cover;text-align:left;-webkit-box-sizing:border-box;-moz-box-sizing:border-box}.content{background:#fff;padding-top:15px}.blog-title,.content{margin:auto;max-width:600px}.blog-title a{display:block;padding-right:16px;padding-left:16px;height:50px;color:#fff;text-decoration:none;font-family:"Open Sans", sans-serif;font-size:16px;line-height:50px;font-weight:600}.post{position:relative;margin-top:0;margin-right:16px;margin-left:16px;padding-bottom:0;max-width:100%;border-bottom:#ebf2f6 1px solid;word-wrap:break-word;font-size:0.95em;line-height:1.65em}.post-header{margin-bottom:1rem}.post-title{margin-bottom:0}.post-title a{text-decoration:none}.post-meta{display:block;margin:3px 0 0 0;color:#9eabb3;font-family:"Open Sans", sans-serif;font-size:1.3rem;line-height:2.2rem}.post-meta a{color:#9eabb3;text-decoration:none}.post-meta a:hover{text-decoration:underline}.post-meta .author{margin:0;font-size:1.3rem;line-height:1.3em}.post-date{display:inline-block;text-transform:uppercase;white-space:nowrap;font-size:1.2rem;line-height:1.2em}.post-image{margin:0;padding-top:3rem;padding-bottom:30px;border-top:1px #E8E8E8 solid}.post-content amp-img,.post-content amp-anim{position:relative;left:50%;display:block;padding:0;min-width:0;max-width:112%;width:calc(100% + 32px);height:auto;transform:translateX(-50%);-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%)}.footnotes{font-size:1.3rem;line-height:1.6em;font-style:italic}.footnotes li{margin:0.6rem 0}.footnotes p{margin:0}.footnotes p a:last-child{text-decoration:none}.site-footer{position:relative;margin:0 auto 20px auto;padding:1rem 15px;max-width:600px;color:rgba(0,0,0,0.5);font-family:"Open Sans", sans-serif;font-size:1.1rem;line-height:1.75em}.site-footer a{color:rgba(0,0,0,0.5);text-decoration:none;font-weight:bold}.site-footer a:hover{border-bottom:#bbc7cc 1px solid}.poweredby{display:block;float:right;width:45%;text-align:right}.copyright{display:block;float:left;width:45%}</style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>

</head>

<body class="amp-template">
    <header class="main-header">
        <nav class="blog-title">
            <a href="../../">Mike Scamell</a>
        </nav>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">Shared Element Transitions - Part 2: Fragments</h1>
                <section class="post-meta">
                    <p class="author">by <a href="../../author/mike/">Mike Scamell</a></p>
                    <time class="post-date" datetime="2017-02-07">2017-02-07</time>
                </section>
            </header>
            <figure class="post-image">
                <amp-img src="http://localhost:2368/content/images/2018/11/shared_element_part_2-4.png" width="600" height="400" layout="responsive"></amp-img>
            </figure>
            <section class="post-content">

                <p>In <a href="http://mikescamell.com/shared-element-transitions-part-1/">part 1</a> we learned what Shared Element Transitions are, how they work and a simple example using <code>Activity</code> to <code>Activity</code>.</p><p>In part 2 we're going to learn a little more on how they should be used and then do a <code>Fragment</code> to <code>Fragment</code> example.</p><h2 id="guidelines">Guidelines</h2><p>There are a few things that should be kept in mind when using Shared Element Transitions. These come from the <a href="https://material.io/guidelines/motion/material-motion.html#material-motion-what-makes-a-good-transition">Material motion</a> guidelines mentioned in part 1.</p><ul><li> While we want the user to marvel at our fantastic new animation, we don't want to impede them on their journey so it's important we animate quickly. If we stagger too many animations or slow it down we're not creating a great user experience. </li><li> Don't do too many Shared Element Transitions at once. When transitioning we want the intention to be clear as possible. Too many Shared Elements potentially crossing paths or moving in different directions can just be confusing. </li><li> Be consistent. If you're using Shared Element Transitions in only one part of your app and you leave out other prime candidates, you're going to have negative impact on the users feelings towards it. It will feel incomplete and will be worse than having no Shared Element Transitions at all. As above though, this doesn't mean go crazy, but by keeping consistency you will help users understand what they mean and their intention. </li></ul><p>To see some prime examples of the above scenarios head <a href="https://material.io/guidelines/motion/material-motion.html#material-motion-what-makes-a-good-transition">here</a>.</p><h2 id="fragment-to-fragment">Fragment to Fragment</h2><p>To get started let's create a simple <code>Activity</code> to hold our <code>Fragment</code>.</p><pre><code>public class FragmentToFragmentActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_fragment_to_fragment);

        getSupportFragmentManager()
                .beginTransaction()
                .add(R.id.content, SimpleFragmentA.newInstance())
                .commit();
    }
}
</code></pre><p>Nothing special here. We're just launching our <code>SimpleFragmentA</code> in <code>onCreate</code> of our <code>FragmentToFragmentActivity</code> by adding it in a <code>Transaction</code>.</p><p>Now we need to setup our <code>SimpleFragmentA</code>. First of all lets make sure our <code>ImageView</code> in our layout XML has a <code>transitionName</code>.</p><pre><code>    &lt;ImageView
        android:id="@+id/fragment_a_imageView"
        android:layout_width="128dp"
        android:layout_height="96dp"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:layout_marginBottom="80dp"
        android:scaleType="centerCrop"
        android:src="@drawable/gorilla"
        android:transitionName="@string/simple_fragment_transition" /&gt;
</code></pre><p>Just like the <code>Activity</code> example we need to set a <code>transitionName</code> (line 10) on BOTH of the views we intend to be part of our Shared Element Transition. Now to the actual <code>Fragment</code> itself.</p><pre><code>    ...

    @Override
    public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {
        super.onViewCreated(view, savedInstanceState);

        final ImageView imageView = (ImageView) view.findViewById(R.id.fragment_a_imageView);

        Button button = (Button) view.findViewById(R.id.fragment_a_btn);
        button.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                SimpleFragmentB simpleFragmentB = SimpleFragmentB.newInstance();
                getFragmentManager()
                        .beginTransaction()
                        .addSharedElement(imageView, ViewCompat.getTransitionName(imageView))
                        .addToBackStack(TAG)
                        .replace(R.id.content, simpleFragmentB)
                        .commit();
            }
        });
    }
</code></pre><p>Our main concern in <code>SimpleFragmentA</code> is the <code>onViewCreated</code> method. On line 7 we're getting hold of our <code>ImageView</code> from the layout. We'll need this for the Shared Element Transition. Line 9 we're getting our button and in line 8 we're setting an <code>onClickListener</code> to get clicks to launch <code>SimpleFragmentB</code>. Line 14 is where things get interesting.</p><p>We create a <code>Transaction</code> as is normal to launch a new <code>Fragment</code>. On line 16 we actually call <code>addSharedElement</code> and, much like the <code>Activity</code> to <code>Activity</code> example from part 1, we need to give our <code>View</code> and <code>transitionName</code> as parameters. So we give our <code>ImageView</code> and our <code>transitionName</code> <s>which is located in <code>strings.xml</code> (We don't want any spelling or typing mistakes!)</s> which we just use <code>ViewCompat.getTransitionName</code> as we know the <code>transitionName</code> in both layouts is the same. Remember, it doesn't have to be and only needs to be unique in the view hierarchy.</p><p>Line 17 we call <code>addToBackStack</code>. Why? Well otherwise we won't get the nice Shared Element Transition when we press back. If this line is left out, when you press back it would just finish the <code>FragmentToFragmentActivity</code> as there's no history (or nothing in the back stack).</p><p>Line 18 we call <code>replace</code> as we want <code>SimpleFragmentB</code> to completely replace <code>SimpleFragmentA</code>.</p><p>Again not too different to how you would normally launch a <code>Fragment</code>. Finally lets get <code>SimpleFragmentB</code> setup.</p><pre><code>    @Override
    public void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) {
            setSharedElementEnterTransition(TransitionInflater.from(getContext()).inflateTransition(android.R.transition.move));
        }
    }
</code></pre><p>Apart from inflating our layout (not shown here) and adding a <code>transitionName</code> to the <code>ImageView</code> in our layout xml (as above in <code>SimpleFragmentA</code>), this is the only other thing we need to do.</p><p>So all we need to do is call <code>setSharedElementTransition</code> and pass in a <code>Transition</code> by inflating one provided to us from resources. This is only available on 21+, which is why we wrap it in an <code>if</code>. By default the "move" transition combines 4 different types.</p><pre><code>&lt;transitionSet xmlns:android="http://schemas.android.com/apk/res/android"&gt;
    &lt;changeBounds/&gt;
    &lt;changeTransform/&gt;
    &lt;changeClipBounds/&gt;
    &lt;changeImageTransform/&gt;
&lt;/transitionSet&gt;
</code></pre><p>We'll go into these in a bit more detail in a future post. But for now, by using these, we're using the same default style of <code>Transition</code> that we used in the <code>Activity</code> to <code>Activity</code> example in part 1.</p><p>And that's it. If we run it, we should have something identical to part 1 except with a Gorilla 😃</p><figure class="kg-card kg-embed-card"><amp-iframe width="459" height="344" src="https://www.youtube.com/embed/_1FlXs78fD8?feature=oembed" frameborder="0" allowfullscreen sandbox="allow-scripts allow-same-origin" layout="responsive"></amp-iframe></figure><p>The source code for part 2 can be found <a href="http://bit.ly/sharedelement">here</a> alongside part 1.</p><p>In part 3 we'll look at how we can use Picasso and Glide with Shared Element Transitions.</p><p><em>Update (5/03/17): I've made some minor adjustments to this post since first releasing. There's nothing better than having 1000's of eyes on your work for reviewing!</em></p><p><em>Thanks to Wesley Ellis, Dimitris Karittevlis and Marcos Holgado for proof reading</em></p>

            </section>

        </article>
    </main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="../../">Mike Scamell</a> © 2018</section>
        <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
    </footer>
</body>
