
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Shared Element Transitions with Picasso and Glide</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css?v=06c3ace0d9">

    <meta name="description" content="A tutorial to show how to implement Shared Element Transitions on Android using Picasso and Glide libraries in Activities and Fragments.">
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="amp/index.html">
    
    <meta property="og:site_name" content="Mike Scamell">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Shared Element Transitions with Picasso and Glide">
    <meta property="og:description" content="A tutorial to show how to implement Shared Element Transitions on Android using Picasso and Glide libraries in Activities and Fragments.">
    <meta property="og:url" content="http://localhost:2368/shared-element-transitions-part-3/">
    <meta property="og:image" content="http://localhost:2368/content/images/2018/11/shared_elements_part_3-6.png">
    <meta property="article:published_time" content="2017-02-14T14:40:00.000Z">
    <meta property="article:modified_time" content="2018-11-18T19:34:47.000Z">
    <meta property="article:tag" content="androiddev">
    <meta property="article:tag" content="sharedelementtranistions">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Shared Element Transitions with Picasso and Glide">
    <meta name="twitter:description" content="A tutorial to show how to implement Shared Element Transitions on Android using Picasso and Glide libraries in Activities and Fragments.">
    <meta name="twitter:url" content="http://localhost:2368/shared-element-transitions-part-3/">
    <meta name="twitter:image" content="http://localhost:2368/content/images/2018/11/shared_elements_part_3-6.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Mike Scamell">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="androiddev, sharedelementtranistions">
    <meta name="twitter:site" content="@mikescamell">
    <meta name="twitter:creator" content="@mikescamell">
    <meta property="og:image:width" content="1280">
    <meta property="og:image:height" content="600">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Mike Scamell",
        "logo": {
            "@type": "ImageObject",
            "url": "http://localhost:2368/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Mike Scamell",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/2a389d50c33966a79a8cf6fe29c6080e?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "http://localhost:2368/author/mike/",
        "sameAs": [
            "https://twitter.com/mikescamell"
        ]
    },
    "headline": "Shared Element Transitions with Picasso and Glide",
    "url": "http://localhost:2368/shared-element-transitions-part-3/",
    "datePublished": "2017-02-14T14:40:00.000Z",
    "dateModified": "2018-11-18T19:34:47.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "http://localhost:2368/content/images/2018/11/shared_elements_part_3-6.png",
        "width": 1280,
        "height": 600
    },
    "keywords": "androiddev, sharedelementtranistions",
    "description": "A tutorial to show how to implement Shared Element Transitions on Android using Picasso and Glide libraries in Activities and Fragments.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:2368/"
    }
}
    </script>

    <script src="../public/ghost-sdk.js?v=06c3ace0d9"></script>
<script>
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "07d57a1d866f"
});
</script>
    <meta name="generator" content="Ghost 2.6">
    <link rel="alternate" type="application/rss+xml" title="Mike Scamell" href="../rss/index.html">
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-59786101-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-59786101-4');
</script>

</head>
<body class="post-template tag-androiddev tag-sharedelementtranistions">

    <div class="site-wrapper">

        

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="../">Mike Scamell</a>
    </div>
    <div class="site-nav-right">
        <div class="social-links">
                <a class="social-link social-link-tw" href="https://twitter.com/mikescamell" title="Twitter" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
</a>
        </div>
            <a class="rss-button" href="https://feedly.com/i/subscription/feed/http://localhost:2368/rss/" title="RSS" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"></circle><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"></path></svg>
</a>
    </div>
</nav>
    </div>
</header>


<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post tag-androiddev tag-sharedelementtranistions ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2017-02-14">14 February 2017</time>
                        <span class="date-divider">/</span> <a href="../tag/androiddev/">androiddev</a>
                </section>
                <h1 class="post-full-title">Shared Element Transitions - Part 3: Picasso &amp; Glide</h1>
            </header>

            <figure class="post-full-image" style="background-image: url(../content/images/2018/11/shared_elements_part_3-6.png)">
            </figure>

            <section class="post-full-content">
                <div class="post-content">
                    <p>In <a href="http://mikescamell.com/shared-element-transitions-part-2/">part 2</a> of this series we looked at guidelines for implementing our Shared Element Transitions and also how we utilise them when going from <code>Fragment</code> to <code>Fragment</code>.</p><p>In part 3 we're going to look at how we can tie together our previous examples using <a href="http://square.github.io/picasso/">Picasso</a> and <a href="https://github.com/bumptech/glide">Glide</a> image loading libraries. These two are probably the most widely used but if you use something else then you can likely still follow the concepts and get the same results.</p><h2 id="picasso">Picasso</h2><p>We're going to be loading our images in both <code>PicassoActivityA</code> and <code>PicassoActivityB</code> using Picasso, not using the xml layout.</p><pre><code>        final ImageView imageView = (ImageView) findViewById(R.id.simple_activity_a_imageView);
        Picasso.with(this)
                .load(TIGER_PIC_URL)
                .fit()
                .centerCrop()
                .into(imageView);

        Button button = (Button) findViewById(R.id.simple_activity_a_btn);
        button.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Intent intent = new Intent(PicassoSimpleActivityA.this, PicassoSimpleActivityB.class);
                ActivityOptionsCompat options = ActivityOptionsCompat.
                        makeSceneTransitionAnimation(PicassoSimpleActivityA.this,
                                imageView,
                                ViewCompat.getTransitionName(imageView));
                startActivity(intent, options.toBundle());
            }
        });
</code></pre><p>Here in <code>PicassoActivityA</code> we're just loading our image into the <code>ImageView</code>, nothing special if you've loaded images with Picasso before.</p><p>Also the same as in part 1 is the creation of the <code>ActivityOptionsCompat</code> so we can pass this as a bundle along with our intent so <code>PicassoActivityB</code> knows we have a Shared Element Transition to do. If this is new to you then head back to <a href="http://mikescamell.com/shared-element-transitions-part-1/">part 1</a> where I explain this in more detail.</p><p>Most of the setup code is in <code>PicassoActivityB</code>, lets take a look.</p><pre><code>    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.picasso_activity_b);
        ImageView imageView = (ImageView) findViewById(R.id.picasso_activity_b_image);

        supportPostponeEnterTransition();

        Picasso.with(this)
                .load(PicassoActivityA.TIGER_PIC_URL)
                .fit()
                .noFade()
                .centerCrop()
                .into(imageView, new Callback() {
                    @Override
                    public void onSuccess() {
                        supportStartPostponedEnterTransition();
                    }

                    @Override
                    public void onError() {
                        supportStartPostponedEnterTransition();
                    }
                });
    }
</code></pre><p>The first thing that's new here is <code>supportPostponeEnterTransition</code> on line 7. This tells the Activity to delay loading until we say it's ok to and the window is left transparent. We need this because we need to ensure that Picasso has loaded the image before we do the transition. Otherwise we'll just get some fade animation for the image. We use <code>supportPostponeEnterTransition</code> rather than <code>postponeEnterTransition</code> because in our sample app we're supporting 19. This just means we don't have to do the <code>if</code> statement to determine the SDK version.</p><p>We load our image in with Picasso, just like <code>PicassoActivityA</code> with a couple of extras. In line 12 we set <code>noFade()</code>. This is a Shared Element Transition so as such we want the image to be on screen at all times. Picasso performs a default fade so we need to turn it off.</p><p>Finally in our into we add an extra <code>Callback</code> parameter to listen for when the image has been loaded. On line 17 and line 22, within the <code>Callback</code> <code>onSuccess</code> and <code>onError</code> methods we call <code>supportStartPostponedEnterTransition</code> to say that now we're ready to start the transition and load the UI for <code>PicassoActivityB</code>. If you don't call <code>supportStartPostponedEnterTransition</code> the <code>Activity</code> will never start.</p><p>And that's it. That's all that's all that's needed extra to load. I won't go through the code doing this for a <code>Fragment</code> to <code>Fragment</code> example as it's so similar to the above and I'm sure you could work it out. I will put the  code in the github project though if you would like to see. There's only one issue I have in with <code>Fragments</code> and that's getting the returning transition back to the previous <code>Fragment</code> to operate with the image in view. If you know how what I'm missing then please let me know!</p><p>One last thing, if you want to force Picasso to use the image from the cache you'll need to set a size for the image, otherwise it won't work properly. Is it necessary? No, but the image in <code>PicassoActivityB</code> will load quicker.</p><h2 id="glide">Glide</h2><p>Glide follows a very similar pattern to the Picasso code with just a few specific Glide method changes. So if you want to know in more detail about what's going on refer to the above text.</p><p><code>GlideActivityA</code> is nothing special and pretty much identical to <code>PicassoActivityA</code> and our <code>SimpleActivityA</code> from part 1.</p><pre><code>        Glide.with(this)
                .load(FOX_PIC_URL)
                .centerCrop()
                .into(imageView);

        Button button = (Button) findViewById(R.id.glide_activity_a_btn);
        button.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Intent intent = new Intent(GlideActivityA.this, GlideActivityB.class);
                ActivityOptionsCompat options = ActivityOptionsCompat.
                        makeSceneTransitionAnimation(GlideActivityA.this,
                                imageView,
                                ViewCompat.getTransitionName(imageView));
                startActivity(intent, options.toBundle());
            }
        });
</code></pre><p><code>GlideActivityB</code> has a the most changes, mostly due to a different way to listen for an image loading.</p><pre><code>        supportPostponeEnterTransition();

        Glide.with(this)
                .load(GlideActivityA.FOX_PIC_URL)
                .centerCrop()
                .dontAnimate()
                .listener(new RequestListener&lt;String, GlideDrawable&gt;() {
                    @Override
                    public boolean onException(Exception e, String model, Target&lt;GlideDrawable&gt; target, boolean isFirstResource) {
                        supportStartPostponedEnterTransition();
                        return false;
                    }

                    @Override
                    public boolean onResourceReady(GlideDrawable resource, String model, Target&lt;GlideDrawable&gt; target, boolean isFromMemoryCache, boolean isFirstResource) {
                        supportStartPostponedEnterTransition();
                        return false;
                    }
                })
                .into(imageView);
</code></pre><p>Line 1 we call <code>supportPostponeEnterTransition()</code> to tell the <code>Activity</code> to wait to load until we tell it to.</p><p>On line 4 we call <code>dontAnimate()</code> which is necessary as we don't want the image to fade in when it's loaded otherwise we'll lose the transition effect.</p><p>On line 5 we set a listener for when the image has been loaded or failed to load. This is so we can call <code>supportStartPostponedEnterTransition()</code> (line 10 &amp; line 16) to start the transition and load the <code>Activity</code>. Note we return false as we want to handle all the image loading rather than doing it manually ourselves.</p><p>Using Glide and <code>Fragment</code> should be easy to work out, but like Picasso I'll include them in the source code. Glide doesn't seem to have the same issues as Picasso when it comes to the return Shared Element Transition not operating correctly with <code>Fragments</code>. Hopefully I can discover out why and update this post in future.</p><p>That source code can be found <a href="http://bit.ly/sharedelement">here</a>.</p><p>This post has been a short one as I was at hackathon this <a href="https://twitter.com/MikeScamell/status/830892953958748162">past weekend</a>. Next week we'll jump into Shared Element Transitions with <code>RecyclerView</code>.</p><p>Any questions hit me up in the comments.</p><p><em>Update (5/03/17): I've made some minor adjustments to this post since first releasing. There's nothing better than having 1000's of eyes on your work for reviewing!</em></p><p><em>Thanks to Christophe Beyls for pointing out the missing supportStartPostponedEnterTransition() in the error methods for Picasso and Glide</em></p>
                </div>
            </section>


            <footer class="post-full-footer">


                    
<section class="author-card">
        <img class="author-profile-image" src="http://www.gravatar.com/avatar/2a389d50c33966a79a8cf6fe29c6080e?s=250&amp;d=mm&amp;r=x" alt="Mike Scamell">
    <section class="author-card-content">
        <h4 class="author-card-name"><a href="../author/mike/">Mike Scamell</a></h4>
            <p>Read <a href="../author/mike/">more posts</a> by this author.</p>
    </section>
</section>
<div class="post-full-footer-right">
    <a class="author-card-button" href="../author/mike/">Read More</a>
</div>


            </footer>


        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
                <article class="read-next-card" style="background-image: url(https://static.ghost.org/v1.0.0/images/blog-cover.jpg)">
                    <header class="read-next-card-header">
                        <small class="read-next-card-header-sitetitle">— Mike Scamell —</small>
                        <h3 class="read-next-card-header-title"><a href="../tag/androiddev/">androiddev</a></h3>
                    </header>
                    <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"></path></svg>
</div>
                    <div class="read-next-card-content">
                        <ul>
                            <li><a href="../bottoms-up-bottomnavigationview-updates-in-the-material-design-design-support-library/">Bottoms Up! - BottomNavigationView Updates in the Material Components/Design Support Library</a></li>
                            <li><a href="../a-sloths-guide-to-learning-kotlin/">A Sloth's guide to learning Kotlin</a></li>
                            <li><a href="../shared-element-transitions-updates/">Shared Element Transitions - Updates</a></li>
                        </ul>
                    </div>
                    <footer class="read-next-card-footer">
                        <a href="../tag/androiddev/">See all 9 posts →</a>
                    </footer>
                </article>

                <article class="post-card post tag-androiddev tag-sharedelementtranistions">
        <a class="post-card-image-link" href="../shared-element-transitions-part-4-recyclerview/">
            <div class="post-card-image" style="background-image: url(../content/images/2018/11/recycler_view_feature-2.png)"></div>
        </a>
    <div class="post-card-content">
        <a class="post-card-content-link" href="../shared-element-transitions-part-4-recyclerview/">
            <header class="post-card-header">
                    <span class="post-card-tags">androiddev</span>
                <h2 class="post-card-title">Shared Element Transitions - Part 4: RecyclerView</h2>
            </header>
            <section class="post-card-excerpt">
                <p>In part 3 of the series we looked at how to implement Shared Element Transitions when using Picasso or Glide.In part 4 we're going to look at implementing them with RecyclerView, a</p>
            </section>
        </a>
        <footer class="post-card-meta">

            <ul class="author-list">
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        Mike Scamell
                    </div>

                        <a href="../author/mike/" class="static-avatar"><img class="author-profile-image" src="http://www.gravatar.com/avatar/2a389d50c33966a79a8cf6fe29c6080e?s=250&amp;d=mm&amp;r=x" alt="Mike Scamell"></a>
                </li>
            </ul>

            <span class="reading-time">7 min read</span>

        </footer>
    </div>
</article>

                <article class="post-card post tag-androiddev tag-sharedelementtranistions">
        <a class="post-card-image-link" href="../shared-element-transitions-part-2/">
            <div class="post-card-image" style="background-image: url(../content/images/2018/11/shared_element_part_2-4.png)"></div>
        </a>
    <div class="post-card-content">
        <a class="post-card-content-link" href="../shared-element-transitions-part-2/">
            <header class="post-card-header">
                    <span class="post-card-tags">androiddev</span>
                <h2 class="post-card-title">Shared Element Transitions - Part 2: Fragments</h2>
            </header>
            <section class="post-card-excerpt">
                <p>In part 1 we learned what Shared Element Transitions are, how they work and a simple example using Activity to Activity.In part 2 we're going to learn a little more on how</p>
            </section>
        </a>
        <footer class="post-card-meta">

            <ul class="author-list">
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        Mike Scamell
                    </div>

                        <a href="../author/mike/" class="static-avatar"><img class="author-profile-image" src="http://www.gravatar.com/avatar/2a389d50c33966a79a8cf6fe29c6080e?s=250&amp;d=mm&amp;r=x" alt="Mike Scamell"></a>
                </li>
            </ul>

            <span class="reading-time">4 min read</span>

        </footer>
    </div>
</article>

        </div>
    </div>
</aside>

<div class="floating-header">
    <div class="floating-header-logo">
        <a href="../">
            <span>Mike Scamell</span>
        </a>
    </div>
    <span class="floating-header-divider">—</span>
    <div class="floating-header-title">Shared Element Transitions - Part 3: Picasso &amp; Glide</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"></path>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Shared%20Element%20Transitions%20-%20Part%203%3A%20Picasso%20%26%20Glide&amp;url=http://localhost:2368/shared-element-transitions-part-3/" onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:2368/shared-element-transitions-part-3/" onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"></path></svg>
        </a>
    </div>
    <progress id="reading-progress" class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="../">Mike Scamell</a> © 2018</section>
                <nav class="site-footer-nav">
                    <a href="../">Latest Posts</a>
                    
                    <a href="https://twitter.com/mikescamell" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>


    <script>
        var images = document.querySelectorAll('.kg-gallery-image img');
        images.forEach(function (image) {
            var container = image.closest('.kg-gallery-image');
            var width = image.attributes.width.value;
            var height = image.attributes.height.value;
            var ratio = width / height;
            container.style.flex = ratio + ' 1 0%';
        })
    </script>


    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="../assets/built/jquery.fitvids.js?v=06c3ace0d9"></script>


    <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('#reading-progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();

});
</script>


    

</body>
