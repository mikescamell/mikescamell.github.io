
<head>
    <meta charset="utf-8">

    <title>Shared Element Transitions with Picasso and Glide</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

    <link rel="shortcut icon" href="../../favicon.ico">

    <meta name="description" content="A tutorial to show how to implement Shared Element Transitions on Android using Picasso and Glide libraries in Activities and Fragments.">
    <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="../index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="Mike Scamell">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Shared Element Transitions with Picasso and Glide">
    <meta property="og:description" content="A tutorial to show how to implement Shared Element Transitions on Android using Picasso and Glide libraries in Activities and Fragments.">
    <meta property="og:url" content="http://localhost:2368/shared-element-transitions-part-3/">
    <meta property="og:image" content="http://localhost:2368/content/images/2018/11/shared_elements_part_3-6.png">
    <meta property="article:published_time" content="2017-02-14T14:40:00.000Z">
    <meta property="article:modified_time" content="2018-11-18T19:34:47.000Z">
    <meta property="article:tag" content="androiddev">
    <meta property="article:tag" content="sharedelementtranistions">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Shared Element Transitions with Picasso and Glide">
    <meta name="twitter:description" content="A tutorial to show how to implement Shared Element Transitions on Android using Picasso and Glide libraries in Activities and Fragments.">
    <meta name="twitter:url" content="http://localhost:2368/shared-element-transitions-part-3/">
    <meta name="twitter:image" content="http://localhost:2368/content/images/2018/11/shared_elements_part_3-6.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Mike Scamell">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="androiddev, sharedelementtranistions">
    <meta name="twitter:site" content="@mikescamell">
    <meta property="og:image:width" content="1280">
    <meta property="og:image:height" content="600">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Mike Scamell",
        "logo": {
            "@type": "ImageObject",
            "url": "http://localhost:2368/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Mike Scamell",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/2a389d50c33966a79a8cf6fe29c6080e?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "http://localhost:2368/author/mike/",
        "sameAs": []
    },
    "headline": "Shared Element Transitions with Picasso and Glide",
    "url": "http://localhost:2368/shared-element-transitions-part-3/",
    "datePublished": "2017-02-14T14:40:00.000Z",
    "dateModified": "2018-11-18T19:34:47.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "http://localhost:2368/content/images/2018/11/shared_elements_part_3-6.png",
        "width": 1280,
        "height": 600
    },
    "keywords": "androiddev, sharedelementtranistions",
    "description": "A tutorial to show how to implement Shared Element Transitions on Android using Picasso and Glide libraries in Activities and Fragments.",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:2368/"
    }
}
    </script>

    <meta name="generator" content="Ghost 2.6">
    <link rel="alternate" type="application/rss+xml" title="Mike Scamell" href="../../rss/index.html">

    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic%7COpen+Sans:700,600,400">
    <style amp-custom>html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}h1{margin:0.67em 0;font-size:2em}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{position:relative;vertical-align:baseline;font-size:75%;line-height:0}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}amp-img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace, monospace;font-size:1em}button,input,optgroup,select,textarea{margin:0;color:inherit;font:inherit}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{cursor:pointer;-webkit-appearance:button}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-appearance:textfield}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{margin:0 2px;padding:0.35em 0.625em 0.75em;border:1px solid #c0c0c0}legend{padding:0;border:0}textarea{overflow:auto}optgroup{font-weight:bold}table{border-spacing:0;border-collapse:collapse}td,th{padding:0}html{max-height:100%;height:100%;font-size:62.5%;-webkit-tap-highlight-color:rgba(0, 0, 0, 0)}body{max-height:100%;height:100%;color:#3a4145;background:#f4f8fb;letter-spacing:0.01rem;font-family:"Merriweather", serif;font-size:1.8rem;line-height:1.75em;text-rendering:geometricPrecision;-webkit-font-feature-settings:"kern" 1;-moz-font-feature-settings:"kern" 1;-o-font-feature-settings:"kern" 1}::-moz-selection{background:#d6edff}::selection{background:#d6edff}h1,h2,h3,h4,h5,h6{margin:0 0 0.3em 0;color:#2e2e2e;font-family:"Open Sans", sans-serif;line-height:1.15em;text-rendering:geometricPrecision;-webkit-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1;-moz-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1;-o-font-feature-settings:"dlig" 1, "liga" 1, "lnum" 1, "kern" 1}h1{text-indent:-2px;letter-spacing:-1px;font-size:2.6rem}h2{letter-spacing:0;font-size:2.4rem}h3{letter-spacing:-0.6px;font-size:2.1rem}h4{font-size:1.9rem}h5{font-size:1.8rem}h6{font-size:1.8rem}a{color:#4a4a4a}a:hover{color:#111}p,ul,ol,dl{margin:0 0 2.5rem 0;font-size:1.5rem;text-rendering:geometricPrecision;-webkit-font-feature-settings:"liga" 1, "onum" 1, "kern" 1;-moz-font-feature-settings:"liga" 1, "onum" 1, "kern" 1;-o-font-feature-settings:"liga" 1, "onum" 1, "kern" 1}ol,ul{padding-left:2em}ol ol,ul ul,ul ol,ol ul{margin:0 0 0.4em 0;padding-left:2em}dl dt{float:left;clear:left;overflow:hidden;margin-bottom:1em;width:180px;text-align:right;text-overflow:ellipsis;white-space:nowrap;font-weight:700}dl dd{margin-bottom:1em;margin-left:200px}li{margin:0.4em 0}li li{margin:0}hr{display:block;margin:1.75em 0;padding:0;height:1px;border:0;border-top:#efefef 1px solid}blockquote{box-sizing:border-box;margin:1.75em 0 1.75em 0;padding:0 0 0 1.75em;border-left:#4a4a4a 0.4em solid;-moz-box-sizing:border-box}blockquote p{margin:0.8em 0;font-style:italic}blockquote small{display:inline-block;margin:0.8em 0 0.8em 1.5em;color:#ccc;font-size:0.9em}blockquote small:before{content:"\2014 \00A0"}blockquote cite{font-weight:700}blockquote cite a{font-weight:normal}mark{background-color:#fdffb6}code,tt{padding:1px 3px;border:#e3edf3 1px solid;background:#f7fafb;border-radius:2px;white-space:pre-wrap;font-family:Inconsolata, monospace, sans-serif;font-size:0.85em;font-feature-settings:"liga" 0;-webkit-font-feature-settings:"liga" 0;-moz-font-feature-settings:"liga" 0}pre{overflow:auto;box-sizing:border-box;margin:0 0 1.75em 0;padding:10px;width:100%;border:#e3edf3 1px solid;background:#f7fafb;border-radius:3px;white-space:pre;font-family:Inconsolata, monospace, sans-serif;font-size:0.9em;-moz-box-sizing:border-box}pre code,pre tt{padding:0;border:none;background:transparent;white-space:pre-wrap;font-size:inherit}kbd{display:inline-block;margin-bottom:0.4em;padding:1px 8px;border:#ccc 1px solid;background:#f4f4f4;border-radius:4px;box-shadow:0 1px 0 rgba(0, 0, 0, 0.2), 0 1px 0 0 #fff inset;color:#666;text-shadow:#fff 0 1px 0;font-size:0.9em;font-weight:700}table{box-sizing:border-box;margin:1.75em 0;max-width:100%;width:100%;background-color:transparent;-moz-box-sizing:border-box}table th,table td{padding:8px;border-top:#efefef 1px solid;vertical-align:top;text-align:left;line-height:20px}table th{color:#000}table caption + thead tr:first-child th,table caption + thead tr:first-child td,table colgroup + thead tr:first-child th,table colgroup + thead tr:first-child td,table thead:first-child tr:first-child th,table thead:first-child tr:first-child td{border-top:0}table tbody + tbody{border-top:#efefef 2px solid}table table table{background-color:#fff}table tbody > tr:nth-child(odd) > td,table tbody > tr:nth-child(odd) > th{background-color:#f6f6f6}table.plain tbody > tr:nth-child(odd) > td,table.plain tbody > tr:nth-child(odd) > th{background:transparent}iframe,amp-iframe,.fluid-width-video-wrapper{display:block;margin:1.75em 0}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper amp-iframe{margin:0}textarea,select,input{margin:0 0 5px 0;padding:6px 9px;width:260px;outline:0;border:#e7eef2 1px solid;background:#fff;border-radius:4px;box-shadow:none;font-family:"Open Sans", sans-serif;font-size:1.6rem;line-height:1.4em;font-weight:100;-webkit-appearance:none}textarea{min-width:250px;min-height:80px;max-width:340px;width:100%;height:auto}input[type="text"]:focus,input[type="email"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="number"]:focus,input[type="date"]:focus,input[type="month"]:focus,input[type="week"]:focus,input[type="time"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,textarea:focus{outline:none;outline-width:0;border:#bbc7cc 1px solid;background:#fff}select{width:270px;height:30px;line-height:30px}.clearfix:before,.clearfix:after{content:" ";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.main-header{position:relative;display:table;overflow:hidden;box-sizing:border-box;width:100%;height:50px;background:#5ba4e5 no-repeat center center;background-size:cover;text-align:left;-webkit-box-sizing:border-box;-moz-box-sizing:border-box}.content{background:#fff;padding-top:15px}.blog-title,.content{margin:auto;max-width:600px}.blog-title a{display:block;padding-right:16px;padding-left:16px;height:50px;color:#fff;text-decoration:none;font-family:"Open Sans", sans-serif;font-size:16px;line-height:50px;font-weight:600}.post{position:relative;margin-top:0;margin-right:16px;margin-left:16px;padding-bottom:0;max-width:100%;border-bottom:#ebf2f6 1px solid;word-wrap:break-word;font-size:0.95em;line-height:1.65em}.post-header{margin-bottom:1rem}.post-title{margin-bottom:0}.post-title a{text-decoration:none}.post-meta{display:block;margin:3px 0 0 0;color:#9eabb3;font-family:"Open Sans", sans-serif;font-size:1.3rem;line-height:2.2rem}.post-meta a{color:#9eabb3;text-decoration:none}.post-meta a:hover{text-decoration:underline}.post-meta .author{margin:0;font-size:1.3rem;line-height:1.3em}.post-date{display:inline-block;text-transform:uppercase;white-space:nowrap;font-size:1.2rem;line-height:1.2em}.post-image{margin:0;padding-top:3rem;padding-bottom:30px;border-top:1px #E8E8E8 solid}.post-content amp-img,.post-content amp-anim{position:relative;left:50%;display:block;padding:0;min-width:0;max-width:112%;width:calc(100% + 32px);height:auto;transform:translateX(-50%);-webkit-transform:translateX(-50%);-ms-transform:translateX(-50%)}.footnotes{font-size:1.3rem;line-height:1.6em;font-style:italic}.footnotes li{margin:0.6rem 0}.footnotes p{margin:0}.footnotes p a:last-child{text-decoration:none}.site-footer{position:relative;margin:0 auto 20px auto;padding:1rem 15px;max-width:600px;color:rgba(0,0,0,0.5);font-family:"Open Sans", sans-serif;font-size:1.1rem;line-height:1.75em}.site-footer a{color:rgba(0,0,0,0.5);text-decoration:none;font-weight:bold}.site-footer a:hover{border-bottom:#bbc7cc 1px solid}.poweredby{display:block;float:right;width:45%;text-align:right}.copyright{display:block;float:left;width:45%}</style>

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>

    

</head>

<body class="amp-template">
    <header class="main-header">
        <nav class="blog-title">
            <a href="../../">Mike Scamell</a>
        </nav>
    </header>

    <main class="content" role="main">
        <article class="post">

            <header class="post-header">
                <h1 class="post-title">Shared Element Transitions - Part 3: Picasso &amp; Glide</h1>
                <section class="post-meta">
                    <p class="author">by <a href="../../author/mike/">Mike Scamell</a></p>
                    <time class="post-date" datetime="2017-02-14">2017-02-14</time>
                </section>
            </header>
            <figure class="post-image">
                <amp-img src="http://localhost:2368/content/images/2018/11/shared_elements_part_3-6.png" width="600" height="400" layout="responsive"></amp-img>
            </figure>
            <section class="post-content">

                <p>In <a href="http://mikescamell.com/shared-element-transitions-part-2/">part 2</a> of this series we looked at guidelines for implementing our Shared Element Transitions and also how we utilise them when going from <code>Fragment</code> to <code>Fragment</code>.</p><p>In part 3 we're going to look at how we can tie together our previous examples using <a href="http://square.github.io/picasso/">Picasso</a> and <a href="https://github.com/bumptech/glide">Glide</a> image loading libraries. These two are probably the most widely used but if you use something else then you can likely still follow the concepts and get the same results.</p><h2 id="picasso">Picasso</h2><p>We're going to be loading our images in both <code>PicassoActivityA</code> and <code>PicassoActivityB</code> using Picasso, not using the xml layout.</p><pre><code>        final ImageView imageView = (ImageView) findViewById(R.id.simple_activity_a_imageView);
        Picasso.with(this)
                .load(TIGER_PIC_URL)
                .fit()
                .centerCrop()
                .into(imageView);

        Button button = (Button) findViewById(R.id.simple_activity_a_btn);
        button.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Intent intent = new Intent(PicassoSimpleActivityA.this, PicassoSimpleActivityB.class);
                ActivityOptionsCompat options = ActivityOptionsCompat.
                        makeSceneTransitionAnimation(PicassoSimpleActivityA.this,
                                imageView,
                                ViewCompat.getTransitionName(imageView));
                startActivity(intent, options.toBundle());
            }
        });
</code></pre><p>Here in <code>PicassoActivityA</code> we're just loading our image into the <code>ImageView</code>, nothing special if you've loaded images with Picasso before.</p><p>Also the same as in part 1 is the creation of the <code>ActivityOptionsCompat</code> so we can pass this as a bundle along with our intent so <code>PicassoActivityB</code> knows we have a Shared Element Transition to do. If this is new to you then head back to <a href="http://mikescamell.com/shared-element-transitions-part-1/">part 1</a> where I explain this in more detail.</p><p>Most of the setup code is in <code>PicassoActivityB</code>, lets take a look.</p><pre><code>    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.picasso_activity_b);
        ImageView imageView = (ImageView) findViewById(R.id.picasso_activity_b_image);

        supportPostponeEnterTransition();

        Picasso.with(this)
                .load(PicassoActivityA.TIGER_PIC_URL)
                .fit()
                .noFade()
                .centerCrop()
                .into(imageView, new Callback() {
                    @Override
                    public void onSuccess() {
                        supportStartPostponedEnterTransition();
                    }

                    @Override
                    public void onError() {
                        supportStartPostponedEnterTransition();
                    }
                });
    }
</code></pre><p>The first thing that's new here is <code>supportPostponeEnterTransition</code> on line 7. This tells the Activity to delay loading until we say it's ok to and the window is left transparent. We need this because we need to ensure that Picasso has loaded the image before we do the transition. Otherwise we'll just get some fade animation for the image. We use <code>supportPostponeEnterTransition</code> rather than <code>postponeEnterTransition</code> because in our sample app we're supporting 19. This just means we don't have to do the <code>if</code> statement to determine the SDK version.</p><p>We load our image in with Picasso, just like <code>PicassoActivityA</code> with a couple of extras. In line 12 we set <code>noFade()</code>. This is a Shared Element Transition so as such we want the image to be on screen at all times. Picasso performs a default fade so we need to turn it off.</p><p>Finally in our into we add an extra <code>Callback</code> parameter to listen for when the image has been loaded. On line 17 and line 22, within the <code>Callback</code> <code>onSuccess</code> and <code>onError</code> methods we call <code>supportStartPostponedEnterTransition</code> to say that now we're ready to start the transition and load the UI for <code>PicassoActivityB</code>. If you don't call <code>supportStartPostponedEnterTransition</code> the <code>Activity</code> will never start.</p><p>And that's it. That's all that's all that's needed extra to load. I won't go through the code doing this for a <code>Fragment</code> to <code>Fragment</code> example as it's so similar to the above and I'm sure you could work it out. I will put the  code in the github project though if you would like to see. There's only one issue I have in with <code>Fragments</code> and that's getting the returning transition back to the previous <code>Fragment</code> to operate with the image in view. If you know how what I'm missing then please let me know!</p><p>One last thing, if you want to force Picasso to use the image from the cache you'll need to set a size for the image, otherwise it won't work properly. Is it necessary? No, but the image in <code>PicassoActivityB</code> will load quicker.</p><h2 id="glide">Glide</h2><p>Glide follows a very similar pattern to the Picasso code with just a few specific Glide method changes. So if you want to know in more detail about what's going on refer to the above text.</p><p><code>GlideActivityA</code> is nothing special and pretty much identical to <code>PicassoActivityA</code> and our <code>SimpleActivityA</code> from part 1.</p><pre><code>        Glide.with(this)
                .load(FOX_PIC_URL)
                .centerCrop()
                .into(imageView);

        Button button = (Button) findViewById(R.id.glide_activity_a_btn);
        button.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Intent intent = new Intent(GlideActivityA.this, GlideActivityB.class);
                ActivityOptionsCompat options = ActivityOptionsCompat.
                        makeSceneTransitionAnimation(GlideActivityA.this,
                                imageView,
                                ViewCompat.getTransitionName(imageView));
                startActivity(intent, options.toBundle());
            }
        });
</code></pre><p><code>GlideActivityB</code> has a the most changes, mostly due to a different way to listen for an image loading.</p><pre><code>        supportPostponeEnterTransition();

        Glide.with(this)
                .load(GlideActivityA.FOX_PIC_URL)
                .centerCrop()
                .dontAnimate()
                .listener(new RequestListener&lt;String, GlideDrawable&gt;() {
                    @Override
                    public boolean onException(Exception e, String model, Target&lt;GlideDrawable&gt; target, boolean isFirstResource) {
                        supportStartPostponedEnterTransition();
                        return false;
                    }

                    @Override
                    public boolean onResourceReady(GlideDrawable resource, String model, Target&lt;GlideDrawable&gt; target, boolean isFromMemoryCache, boolean isFirstResource) {
                        supportStartPostponedEnterTransition();
                        return false;
                    }
                })
                .into(imageView);
</code></pre><p>Line 1 we call <code>supportPostponeEnterTransition()</code> to tell the <code>Activity</code> to wait to load until we tell it to.</p><p>On line 4 we call <code>dontAnimate()</code> which is necessary as we don't want the image to fade in when it's loaded otherwise we'll lose the transition effect.</p><p>On line 5 we set a listener for when the image has been loaded or failed to load. This is so we can call <code>supportStartPostponedEnterTransition()</code> (line 10 &amp; line 16) to start the transition and load the <code>Activity</code>. Note we return false as we want to handle all the image loading rather than doing it manually ourselves.</p><p>Using Glide and <code>Fragment</code> should be easy to work out, but like Picasso I'll include them in the source code. Glide doesn't seem to have the same issues as Picasso when it comes to the return Shared Element Transition not operating correctly with <code>Fragments</code>. Hopefully I can discover out why and update this post in future.</p><p>That source code can be found <a href="http://bit.ly/sharedelement">here</a>.</p><p>This post has been a short one as I was at hackathon this <a href="https://twitter.com/MikeScamell/status/830892953958748162">past weekend</a>. Next week we'll jump into Shared Element Transitions with <code>RecyclerView</code>.</p><p>Any questions hit me up in the comments.</p><p><em>Update (5/03/17): I've made some minor adjustments to this post since first releasing. There's nothing better than having 1000's of eyes on your work for reviewing!</em></p><p><em>Thanks to Christophe Beyls for pointing out the missing supportStartPostponedEnterTransition() in the error methods for Picasso and Glide</em></p>

            </section>

        </article>
    </main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="../../">Mike Scamell</a> © 2018</section>
        <section class="poweredby">Proudly published with <a href="https://ghost.org">Ghost</a></section>
    </footer>
</body>
