
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Shared Element Transitions with RecyclerView</title>
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css?v=3bea6074d0">

    <meta name="description" content="A tutorial to show how to implement Shared Element Transitions on Android when using a RecyclerView and going to a new Activity, Fragment or ViewPager.">
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <link rel="canonical" href="https://mikescamell.com/shared-element-transitions-part-4-recyclerview/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="https://mikescamell.com/shared-element-transitions-part-4-recyclerview/amp/">
    
    <meta property="og:site_name" content="Mike Scamell">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Shared Element Transitions with RecyclerView">
    <meta property="og:description" content="In part 3 [http://mikescamell.com/shared-element-transitions-part-3/]  of the
series we looked at how to implement Shared Element Transitions when using
Picasso or Glide.

In part 4 we're going to look at implementing them with RecyclerView, a popular
use case with apps that have Shared Element Transitions. An example of this is
Google Play Music, which i mentioned in part 1
[http://mikescamell.com/shared-element-transitions-part-1/], but there are
plenty more out there.  Pocket Casts is another">
    <meta property="og:url" content="http://localhost:2368/shared-element-transitions-part-4-recyclerview/">
    <meta property="og:image" content="http://localhost:2368/content/images/2018/11/recycler_view_feature-2.png">
    <meta property="article:published_time" content="2017-02-21T15:01:00.000Z">
    <meta property="article:modified_time" content="2018-11-18T21:42:59.000Z">
    <meta property="article:tag" content="androiddev">
    <meta property="article:tag" content="sharedelementtranistions">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Shared Element Transitions with RecyclerView">
    <meta name="twitter:description" content="In part 3 [http://mikescamell.com/shared-element-transitions-part-3/]  of the
series we looked at how to implement Shared Element Transitions when using
Picasso or Glide.

In part 4 we're going to look at implementing them with RecyclerView, a popular
use case with apps that have Shared Element Transitions. An example of this is
Google Play Music, which i mentioned in part 1
[http://mikescamell.com/shared-element-transitions-part-1/], but there are
plenty more out there.  Pocket Casts is another">
    <meta name="twitter:url" content="http://localhost:2368/shared-element-transitions-part-4-recyclerview/">
    <meta name="twitter:image" content="http://localhost:2368/content/images/2018/11/recycler_view_feature-2.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Mike Scamell">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="androiddev, sharedelementtranistions">
    <meta name="twitter:site" content="@mikescamell">
    <meta name="twitter:creator" content="@mikescamell">
    <meta property="og:image:width" content="1280">
    <meta property="og:image:height" content="600">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Mike Scamell",
        "logo": {
            "@type": "ImageObject",
            "url": "http://localhost:2368/favicon.ico",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Mike Scamell",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/2a389d50c33966a79a8cf6fe29c6080e?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "http://localhost:2368/author/mike/",
        "sameAs": [
            "https://twitter.com/mikescamell"
        ]
    },
    "headline": "Shared Element Transitions with RecyclerView",
    "url": "http://localhost:2368/shared-element-transitions-part-4-recyclerview/",
    "datePublished": "2017-02-21T15:01:00.000Z",
    "dateModified": "2018-11-18T21:42:59.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "http://localhost:2368/content/images/2018/11/recycler_view_feature-2.png",
        "width": 1280,
        "height": 600
    },
    "keywords": "androiddev, sharedelementtranistions",
    "description": "In part 3 [http://mikescamell.com/shared-element-transitions-part-3/]  of the\nseries we looked at how to implement Shared Element Transitions when using\nPicasso or Glide.\n\nIn part 4 we&#x27;re going to look at implementing them with RecyclerView, a popular\nuse case with apps that have Shared Element Transitions. An example of this is\nGoogle Play Music, which i mentioned in part 1\n[http://mikescamell.com/shared-element-transitions-part-1/], but there are\nplenty more out there.  Pocket Casts is another",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:2368/"
    }
}
    </script>

    <script src="../public/ghost-sdk.js?v=3bea6074d0"></script>
<script>
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "07d57a1d866f"
});
</script>
    <meta name="generator" content="Ghost 2.21">
    <link rel="alternate" type="application/rss+xml" title="Mike Scamell" href="https://mikescamell.com/rss/">
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-59786101-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-59786101-4');
</script>

<link rel="stylesheet" type="text/css" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/themes/prism.min.css">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/line-numbers/prism-line-numbers.min.css">

</head>
<body class="post-template tag-androiddev tag-sharedelementtranistions">

    <div class="site-wrapper">

        

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
                <a class="site-nav-logo" href="https://mikescamell.com">Mike Scamell</a>
            <ul class="nav" role="menu">
    <li class="nav-blog" role="menuitem"><a href="https://mikescamell.com/">Blog</a></li>
    <li class="nav-talks" role="menuitem"><a href="https://mikescamell.com/talks/">Talks</a></li>
    <li class="nav-github" role="menuitem"><a href="https://github.com/mikescamell">Github</a></li>
</ul>

    </div>
    <div class="site-nav-right">
        <div class="social-links">
                <a class="social-link social-link-tw" href="https://twitter.com/mikescamell" title="Twitter" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
</a>
        </div>
            <a class="rss-button" href="https://feedly.com/i/subscription/feed/http://localhost:2368/rss/" title="RSS" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"></circle><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"></path></svg>
</a>
    </div>
</nav>
    </div>
</header>


<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post tag-androiddev tag-sharedelementtranistions ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="2017-02-21">21 February 2017</time>
                        <span class="date-divider">/</span> <a href="../tag/androiddev/">androiddev</a>
                </section>
                <h1 class="post-full-title">Shared Element Transitions - Part 4: RecyclerView</h1>
            </header>

            <figure class="post-full-image">
                <img srcset="../content/images/size/w300/2018/11/recycler_view_feature-2.png 300w,
                           ../content/images/size/w600/2018/11/recycler_view_feature-2.pngg 600w,
                          ../content/images/size/w1000/2018/11/recycler_view_feature-2.png 1000w,
                         ../content/images/size/w2000/2018/11/recycler_view_feature-2.png 2000w" sizes="(max-width: 800px) 400px,
                            (max-width: 1170px) 700px,
                            1400px" src="../content/images/size/w2000/2018/11/recycler_view_feature-2.png" alt="Shared Element Transitions - Part 4: RecyclerView">
            </figure>

            <section class="post-full-content">
                <div class="post-content">
                    <p>In <a href="http://mikescamell.com/shared-element-transitions-part-3/">part 3</a> of the series we looked at how to implement Shared Element Transitions when using Picasso or Glide.</p><p>In part 4 we're going to look at implementing them with <code>RecyclerView</code>, a popular use case with apps that have Shared Element Transitions. An example of this is Google Play Music, which i mentioned in <a href="http://mikescamell.com/shared-element-transitions-part-1/">part 1</a>, but there are plenty more out there.  Pocket Casts is another good example:</p><figure class="kg-card kg-embed-card"><iframe width="459" height="344" src="https://www.youtube.com/embed/Jvu8lJIWNgA?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><p>We're going to make something similar, going from a gallery of Animals to a detail page telling us a bit more info. Here's our two screens:</p><figure class="kg-card kg-image-card"><img src="https://mikescamell.com/content/images/2017/02/recycler_view_example.jpg" class="kg-image" alt="Gallery View and Animal Detail Screen"></figure><p>I'm going to show three examples. Two using <code>Activity</code> and <code>Fragment</code> to go from a <code>RecyclerView</code> to a simple detail view. Finally one going from a <code>RecyclerView</code> to a <code>ViewPager</code>.</p><p>There's one key point that I want to get across, in case you decide to skip to other parts of the post. That is that Shared Element Transitions need a UNIQUE transition name. This is easy to forget but is key when doing them with <code>RecyclerView</code>. Enough chuff, let's get on with it!</p><h2 id="common-code">Common Code</h2><p>First of all lets look at some common code to all the examples. Let's start with the layout for the gallery items.</p><h3 id="animal-gallery-item-layout">Animal Gallery Item Layout</h3><pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="150dp"
    android:layout_marginBottom="16dp"&gt;

    &lt;ImageView
        android:id="@+id/item_animal_square_image"
        android:layout_width="match_parent"
        android:layout_height="match_parent" /&gt;

&lt;/RelativeLayout&gt;
</code></pre><p>Nothing fancy, but the key thing to note is there is NO <code>transitionName</code> attribute set on the <code>ImageView</code>.</p><h3 id="animal-gallery-adapter">Animal Gallery Adapter</h3><pre><code>public class AnimalGalleryAdapter extends RecyclerView.Adapter&lt;AnimalGalleryAdapter.ImageViewHolder&gt; {

    private final AnimalItemClickListener animalItemClickListener;
    private ArrayList&lt;AnimalItem&gt; animalItems;

    public AnimalGalleryAdapter(ArrayList&lt;AnimalItem&gt; animalItems, AnimalItemClickListener animalItemClickListener) {
        this.animalItems = animalItems;
        this.animalItemClickListener = animalItemClickListener;
    }

    ....

    @Override
    public void onBindViewHolder(final ImageViewHolder holder, int position) {
        final AnimalItem animalItem = animalItems.get(position);

        Picasso.with(holder.itemView.getContext())
                .load(animalItem.imageUrl)
                .into(holder.animalImageView);

        ViewCompat.setTransitionName(holder.animalImageView, animalItem.name);

        holder.itemView.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                animalItemClickListener.onAnimalItemClick(holder.getAdapterPosition(), animalItem, holder.animalImageView);
            }
        });
    }
}
</code></pre><p>Here we have our <code>AnimalGalleryAdapter</code>. This will be used throughout all the examples to show the gallery images.</p><p>On line 6 in the constructor we ask for an <code>AnimalItemClickListener</code> which will handle calling back to the relevant <code>Activity</code> or <code>Fragment</code> to launch the animal detail screen.</p><p>The <code>onBindViewHolder</code> method is where we set the <code>transitionName</code>. As previously mentioned, this has to be unique in the view hierarchy, so we <s>construct one with an arbitrary string and append the position of the item onto the end.</s> use the Animal's name as we know this will be unique. It's best if you can use some unique identifier derived from your model. If we set the <code>transitionName</code> in XML then all <code>ImageView</code> in the gallery would have the same one, which means when we came back to the gallery the framework would have no idea where to move the image to. Which results in some weird image movement and clashing! Line 21 we set the <code>transitionName</code> on the <code>ImageView</code> using <code>ViewCompat</code>. <s>Line 23 we set the dynamic <code>transitionName</code> on the <code>ImageView</code>.</s></p><p>We fire <code>onAnimalItemClick</code> on line 26 when an image is tapped. We give it the position, the <code>AnimalItem</code> that was clicked, and finally the <code>ImageView</code>. <s>and finally <code>transitionName</code>. The <code>transitionName</code> isn't entirely necessary as we set it on the <code>ImageView</code>, but it help keeps the code cleaner as calling <code>getTransitionName</code> on an <code>ImageView</code> is only available 21+.</s> We can use <code>ViewCompat</code> to call <code>getTransitionName</code> on the <code>ImageView</code> as we have done in previous examples.</p><h3 id="animal-item">Animal Item</h3><pre><code>public class AnimalItem implements Parcelable {

    public String name;
    public String detail;
    public String imageUrl;

    ...
}
</code></pre><p>Our AnimalItem is pretty simple. We need the image URL to tell Picasso (can easily be swapped for Glide) what image to load in our detail <code>Activity</code> or <code>Fragment</code>. It's also <code>Parcelable</code> so we can pass on through by adding to the extras <code>Bundle</code> of the <code>Intent</code>.</p><h2 id="recyclerview-to-activity">RecyclerView to Activity</h2><p>This is probably the most simple to implement. In our <code>RecyclerViewActivity</code> we just need to handle the <code>onAnimalItemClick</code> and launch the <code>AnimalDetailActivity</code>.</p><pre><code>public class RecyclerViewActivity extends AppCompatActivity implements AnimalItemClickListener {

    //Code to setup the RecyclerView and Adapter

    @Override
    public void onAnimalItemClick(int pos, AnimalItem animalItem, ImageView sharedImageView) {
        Intent intent = new Intent(this, AnimalDetailActivity.class);
        intent.putExtra(EXTRA_ANIMAL_ITEM, animalItem);
        intent.putExtra(EXTRA_ANIMAL_IMAGE_TRANSITION_NAME, ViewCompat.getTransitionName(sharedImageView));

        ActivityOptionsCompat options = ActivityOptionsCompat.makeSceneTransitionAnimation(
                this,
                sharedImageView,
                ViewCompat.getTransitionName(sharedImageView));

        startActivity(intent, options.toBundle());
    }

}
</code></pre><p>Line 8 and 9 we put our <code>AnimalItem</code> and <code>transitionName</code> in the <code>Bundle</code> to be passed through to the <code>AnimalDetailActivity</code>. Line 11-14 we do what we did in <a href="http://mikescamell.com/shared-element-transitions-part-1/">part 1</a> and create <code>ActivityOptions</code> using the <code>ImageView</code> passed through from the <code>AnimalGalleryAdapter</code>. <s>and the <code>transitionName</code>.</s> We add the <code>ActivityOptions</code> when we call <code>startActivity</code> on line 16.</p><p>Now we need to setup the <code>AnimalDetailActivity</code>.</p><pre><code>public class AnimalDetailActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_animal_detail);
        supportPostponeEnterTransition();

        Bundle extras = getIntent().getExtras();
        AnimalItem animalItem = extras.getParcelable(RecyclerViewActivity.EXTRA_ANIMAL_ITEM);

        ImageView imageView = (ImageView) findViewById(R.id.animal_detail_image_view);
        TextView textView = (TextView) findViewById(R.id.animal_detail_text);
        textView.setText(animalItem.detail);

        String imageUrl = animalItem.imageUrl;
        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) {
            String imageTransitionName = extras.getString(RecyclerViewActivity.EXTRA_ANIMAL_IMAGE_TRANSITION_NAME);
            imageView.setTransitionName(imageTransitionName);
        }

        Picasso.with(this)
                .load(imageUrl)
                .noFade()
                .into(imageView, new Callback() {
                    @Override
                    public void onSuccess() {
                        supportStartPostponedEnterTransition();
                    }

                    @Override
                    public void onError() {
                        supportStartPostponedEnterTransition();
                    }
                });
    }
}
</code></pre><p>We need to stop the <code>AnimalDetailActivity</code> loading before Picasso has finished loading the image from the image url. So line 7 we call <code>supportPostponeEnterTransition</code> to tell it to wait. Line 19 we get the <code>transitionName</code> from the <code>extras</code> and set it on the <code>ImageView</code> of the <code>AnimalDetailActivity</code>. This is key, as we DON'T set the <code>transitionName</code> in the layout XML of the <code>AnimalDetailActivity</code>. <s>This is because we don't know it until someone has actually clicked an Animal from the gallery. So we have to set it dynamically.</s> It's not necessary though, and if you wanted you could set this on the <code>ImageView</code> via the layout if you like, but you'd need to set it when creating the <code>ActivityOptionsCompat</code> in <code>RecyclerViewActivity</code>. Line 23-36 we use Picasso to load the image and in the <code>onSuccess</code> and <code>onError</code> methods of the callback we tell the <code>AnimalDetailActivity</code> that it can now launch by calling <code>supportStartPostponedEnterTransition</code>. This was talked about in detail in <a href="http://mikescamell.com/shared-element-transitions-part-3/">part 3</a>. With that everything should work!</p><figure class="kg-card kg-embed-card"><iframe width="459" height="344" src="https://www.youtube.com/embed/B_TUNYnnXo4?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><h2 id="recyclerview-to-fragment">RecyclerView to Fragment</h2><p>There's not too much difference between using a <code>Fragment</code> compared with the above code for the <code>Activity</code> example. So I'm just going to touch on the key differences. Here's our <code>RecyclerViewFragment</code> which gets loaded from the <code>Activity</code> that holds the Fragments.</p><pre><code>public class RecyclerViewFragment extends Fragment implements AnimalItemClickListener {

    //Code to setup RecyclerView and Adapter

    @Override
    public void onAnimalItemClick(int pos, AnimalItem animalItem, ImageView sharedImageView, String transitionName) {
        Fragment animalDetailFragment = AnimalDetailFragment.newInstance(animalItem, transitionName);
        getFragmentManager()
                .beginTransaction()
                .addSharedElement(sharedImageView, ViewCompat.getTransitionName(sharedImageView))
                .addToBackStack(TAG)
                .replace(R.id.content, animalDetailFragment)
                .commit();
    }
}
</code></pre><p>In the <code>onAnimalItemClick</code> method we create our <code>FragmentTransaction</code>. On line 10 we add the <code>ImageView</code> <s>and dynamic <code>transitionName</code></s> that has been passed through from the <code>AnimalGalleryAdapter</code>. We use it to get the <code>transitionName</code>. Just like the <code>Activity</code> example, we need to pass through our <code>AnimalItem</code> and <code>transitionName</code> which we do when creating our <code>Fragment</code> on line 7.</p><pre><code>public class AnimalDetailFragment extends Fragment {

    @Override
    public void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        postponeEnterTransition();
        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) {
            setSharedElementEnterTransition(TransitionInflater.from(getContext()).inflateTransition(android.R.transition.move));
        }
    }

    @Override
    public void onViewCreated(View view, @Nullable Bundle savedInstanceState) {
        super.onViewCreated(view, savedInstanceState);

        AnimalItem animalItem = getArguments().getParcelable(EXTRA_ANIMAL_ITEM);
        String transitionName = getArguments().getString(EXTRA_TRANSITION_NAME);

        TextView detailTextView = (TextView) view.findViewById(R.id.animal_detail_text);
        detailTextView.setText(animalItem.detail);

        ImageView imageView = (ImageView) view.findViewById(R.id.animal_detail_image_view);
        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) {
            imageView.setTransitionName(transitionName);
        }

        Picasso.with(getContext())
                .load(animalItem.imageUrl)
                .noFade()
                .into(imageView, new Callback() {
                    @Override
                    public void onSuccess() {
                        startPostponedEnterTransition();
                    }

                    @Override
                    public void onError() {
                        startPostponedEnterTransition();
                    }
                });
    }
}
</code></pre><p>Again, just like the <code>Activity</code> example we have to tell the <code>Fragment</code> to wait to load until we tell it so by calling <code>postponeEnterTransition()</code> on line 7. Line 9 we call <code>setSharedElementTransition()</code> otherwise we won't get one and we just inflate the transition <code>move</code> from the Android resources to tell it what type of <code>Transition</code> we want.</p><p>Line 25 we set the <code>transitionName</code> on the <code>ImageView</code>. <s>as it's dynamic.</s> Like the Actvivity example, this isn't necessary and we could just set a <code>transitionName</code> via XML and then use it here. We load the image using Picasso (28-41) and make sure we call <code>startPostponedEnterTransition()</code> in the image load callback's <code>onSuccess()</code> and <code>OnError()</code> methods so that the <code>Fragment</code> actually loads.</p><p>So as you can see, apart from the <code>Fragment</code> specific calls, the <code>Activity</code> and <code>Fragment</code> examples are both pretty much the same. I won't post a video as it's identical to the one above for the <code>Activity</code>!</p><h2 id="bonus-recyclerview-to-viewpager">Bonus: RecyclerView to ViewPager</h2><p>I was asked about this scenario last week and so I've decided to throw it in as well. There's just one caveat to this example. As you'll likely know the nature of a ViewPager is that you can swipe to change pages. This proves an issue with a Shared Element Transition's return transition. You might have moved in the ViewPager and no longer have the <code>View</code> you did the Shared Element Transition with in the first place. If you do there's also the chance you'll be on an adjacent page, so when you press back the first image transitions back rather than the one that you are on. Take a look at the video to see what I mean.</p><figure class="kg-card kg-embed-card"><iframe width="459" height="344" src="https://www.youtube.com/embed/gy3i4UDmuTo?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><p>There's hardly any difference in code to the above <code>Fragment</code> example apart from using a <code>ViewPager</code> and this little snippet:</p><pre><code>public class AnimalViewPagerFragment extends Fragment {

    ///Other setup code

    @Override
    public void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        postponeEnterTransition();
        if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) {
            setSharedElementEnterTransition(TransitionInflater.from(getContext()).inflateTransition(android.R.transition.move));
        }
        setSharedElementReturnTransition(null);
    }
}
</code></pre><p>On line 12 we call <code>setSharedElementReturnTransition()</code> and set it to <code>null</code> so that it doesn't perform a return Shared Element Transition. This way, when the back buttons pressed, there'll be no odd return transition. If you know a way round this I'd be keen to hear, I have a few ideas myself but I ran out of time this week to try them! Note I'm calling this on the <code>Fragment</code> that's going to be created, NOT the one that's loading it. It'll look something like this:</p><figure class="kg-card kg-embed-card"><iframe width="459" height="344" src="https://www.youtube.com/embed/SlmWd-45KtY?feature=oembed" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><p>And that's it for this week. In part 5 I'll be focusing on gotchas. We'll use some of the previous examples and get them into a state when we no longer have that nasty white flash! If you haven't seen it go back and look at some of the videos above. You'll never unsee it again! We'll also look at stopping the images overlapping the navigation and status bars.</p><p>The source code for this can be found <a href="https://github.com/mikescamell/shared-element-transitions">here</a> under the package <code>recycler_view</code>.</p><p><em>Update (5/03/17): I've made some minor adjustments to this post since first releasing. There's nothing better than having 1000's of eyes on your work for reviewing!</em></p>
                </div>
            </section>


            <footer class="post-full-footer">


                    
<section class="author-card">
        <img class="author-profile-image" src="http://www.gravatar.com/avatar/2a389d50c33966a79a8cf6fe29c6080e?s=250&amp;d=mm&amp;r=x" alt="Mike Scamell">
    <section class="author-card-content">
        <h4 class="author-card-name"><a href="../author/mike/">Mike Scamell</a></h4>
            <p>Read <a href="../author/mike/">more posts</a> by this author.</p>
    </section>
</section>
<div class="post-full-footer-right">
    <a class="author-card-button" href="../author/mike/">Read More</a>
</div>


            </footer>


        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
                <article class="read-next-card">
                    <header class="read-next-card-header">
                        <small class="read-next-card-header-sitetitle">— Mike Scamell —</small>
                        <h3 class="read-next-card-header-title"><a href="../tag/androiddev/">androiddev</a></h3>
                    </header>
                    <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"></path></svg>
</div>
                    <div class="read-next-card-content">
                        <ul>
                            <li><a href="../motionlayoutquickie-ontouchup/">MotionLayout Quickie - onTouchUp</a></li>
                            <li><a href="../bottoms-up-bottomnavigationview-updates-in-the-material-design-design-support-library/">Bottoms Up! - BottomNavigationView Updates in the Material Components/Design Support Library</a></li>
                            <li><a href="../a-sloths-guide-to-learning-kotlin/">A Sloth's guide to learning Kotlin</a></li>
                        </ul>
                    </div>
                    <footer class="read-next-card-footer">
                        <a href="../tag/androiddev/">See all 10 posts →</a>
                    </footer>
                </article>

                <article class="post-card post tag-sharedelementtranistions tag-androiddev ">

    <a class="post-card-image-link" href="../shared-element-transitions-part-5/">
        <img class="post-card-image" srcset="../content/images/size/w300/2018/11/flash_fix.png 300w,
                   ../content/images/size/w600/2018/11/flash_fix.pngg 600w,
                  ../content/images/size/w1000/2018/11/flash_fix.png 1000w,
                 ../content/images/size/w2000/2018/11/flash_fix.png 2000w" sizes="(max-width: 1000px) 400px, 700px" src="../content/images/size/w600/2018/11/flash_fix.png" alt="Shared Element Transitions - Part 5:  Fixing Flashing/Blinking">
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../shared-element-transitions-part-5/">

            <header class="post-card-header">
                    <span class="post-card-tags">sharedelementtranistions</span>
                <h2 class="post-card-title">Shared Element Transitions - Part 5:  Fixing Flashing/Blinking</h2>
            </header>

            <section class="post-card-excerpt">
                <p>In part 4 of the series we explored combining Shared Element Transitions with RecyclerView.In part 5 we're going to fix the white flashing or blinking that you may have seen throughout the</p>
            </section>

        </a>

        <footer class="post-card-meta">

            <ul class="author-list">
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        Mike Scamell
                    </div>

                        <a href="../author/mike/" class="static-avatar">
                            <img class="author-profile-image" src="http://www.gravatar.com/avatar/2a389d50c33966a79a8cf6fe29c6080e?s=250&amp;d=mm&amp;r=x" alt="Mike Scamell">
                        </a>
                </li>
            </ul>

            <span class="reading-time">4 min read</span>

        </footer>

    </div>

</article>

                <article class="post-card post tag-androiddev tag-sharedelementtranistions ">

    <a class="post-card-image-link" href="../shared-element-transitions-part-3/">
        <img class="post-card-image" srcset="../content/images/size/w300/2018/11/shared_elements_part_3-6.png 300w,
                   ../content/images/size/w600/2018/11/shared_elements_part_3-6.pngg 600w,
                  ../content/images/size/w1000/2018/11/shared_elements_part_3-6.png 1000w,
                 ../content/images/size/w2000/2018/11/shared_elements_part_3-6.png 2000w" sizes="(max-width: 1000px) 400px, 700px" src="../content/images/size/w600/2018/11/shared_elements_part_3-6.png" alt="Shared Element Transitions - Part 3: Picasso &amp; Glide">
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../shared-element-transitions-part-3/">

            <header class="post-card-header">
                    <span class="post-card-tags">androiddev</span>
                <h2 class="post-card-title">Shared Element Transitions - Part 3: Picasso &amp; Glide</h2>
            </header>

            <section class="post-card-excerpt">
                <p>In part 2 of this series we looked at guidelines for implementing our Shared Element Transitions and also how we utilise them when going from Fragment to Fragment.In part 3 we're going</p>
            </section>

        </a>

        <footer class="post-card-meta">

            <ul class="author-list">
                <li class="author-list-item">

                    <div class="author-name-tooltip">
                        Mike Scamell
                    </div>

                        <a href="../author/mike/" class="static-avatar">
                            <img class="author-profile-image" src="http://www.gravatar.com/avatar/2a389d50c33966a79a8cf6fe29c6080e?s=250&amp;d=mm&amp;r=x" alt="Mike Scamell">
                        </a>
                </li>
            </ul>

            <span class="reading-time">4 min read</span>

        </footer>

    </div>

</article>

        </div>
    </div>
</aside>

<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://mikescamell.com">
            <span>Mike Scamell</span>
        </a>
    </div>
    <span class="floating-header-divider">—</span>
    <div class="floating-header-title">Shared Element Transitions - Part 4: RecyclerView</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"></path>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Shared%20Element%20Transitions%20-%20Part%204%3A%20RecyclerView&amp;url=https://mikescamell.com/shared-element-transitions-part-4-recyclerview/" onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"></path></svg>
        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://mikescamell.com/shared-element-transitions-part-4-recyclerview/" onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"></path></svg>
        </a>
    </div>
    <progress id="reading-progress" class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://mikescamell.com">Mike Scamell</a> © 2019</section>
                <nav class="site-footer-nav">
                    <a href="https://mikescamell.com">Latest Posts</a>
                    
                    <a href="https://twitter.com/mikescamell" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>


    <script>
        var images = document.querySelectorAll('.kg-gallery-image img');
        images.forEach(function (image) {
            var container = image.closest('.kg-gallery-image');
            var width = image.attributes.width.value;
            var height = image.attributes.height.value;
            var ratio = width / height;
            container.style.flex = ratio + ' 1 0%';
        })
    </script>


    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="../assets/built/jquery.fitvids.js?v=3bea6074d0"></script>


    <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('#reading-progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();

});
</script>


    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/plugins/line-numbers/prism-line-numbers.min.js"></script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.16.0/components/prism-xml.min.js"></script>

</body>
